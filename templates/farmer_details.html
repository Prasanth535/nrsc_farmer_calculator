{% extends "base.html" %}
{% block content %}
<div class="card">
    <h2>Farmer Details</h2>

    <form method="post" class="form-grid">
        <label>Enter Name
            <div class="input-with-mic">
                <input type="text" id="name" name="name" value="{{ farmer.get('name', '') }}" required>
                <button type="button" class="mic-btn" onclick="startDictation('name')">ðŸŽ¤</button>
            </div>
        </label>

        <label>Enter Mobile Number
            <div class="input-with-mic">
                <input type="text" id="mobile" name="mobile" value="{{ farmer.get('mobile', '') }}" required>
                <button type="button" class="mic-btn" onclick="startDictation('mobile')">ðŸŽ¤</button>
            </div>
        </label>

        <label>Enter Village Name
            <div class="input-with-mic">
                <input type="text" id="village" name="village" value="{{ farmer.get('village', '') }}" required>
                <button type="button" class="mic-btn" onclick="startDictation('village')">ðŸŽ¤</button>
            </div>
        </label>

        <label>Enter Mandal Name
            <div class="input-with-mic">
                <input type="text" id="mandal" name="mandal" value="{{ farmer.get('mandal', '') }}" required>
                <button type="button" class="mic-btn" onclick="startDictation('mandal')">ðŸŽ¤</button>
            </div>
        </label>

        <label>Enter District Name
            <div class="input-with-mic">
                <input type="text" id="district" name="district" value="{{ farmer.get('district', '') }}" required>
                <button type="button" class="mic-btn" onclick="startDictation('district')">ðŸŽ¤</button>
            </div>
        </label>

        <button type="submit" class="primary-btn">PROCEED</button>
    </form>
</div>

<script>
/* Simple voice assistant using Web Speech API */
function startDictation(fieldId) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
        alert("Speech recognition is not supported in this browser. Please use Chrome or Edge.");
        return;
    }
    const recognition = new SpeechRecognition();
    recognition.lang = 'en-IN';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.onresult = function (event) {
        const transcript = event.results[0][0].transcript;
        const input = document.getElementById(fieldId);
        if (input) {
            input.value = transcript;
        }
    };
    recognition.onerror = function (event) {
        console.error(event.error);
        alert("Voice input error: " + event.error);
    };
    recognition.start();
}
</script>
{% endblock %}
